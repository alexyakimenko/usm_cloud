# Лабораторная работа №2. Введение в AWS. Вычислительные сервисы

## Цель работы

Познакомиться с основными вычислительными сервисами AWS, научиться создавать и настраивать виртуальные машины (EC2), а также развёртывать простые веб-приложения.

## Задание 1. Создание IAM группы и пользователя

Создаю админ группу и пользователя

Для группы Admins указываю политику AdministratorAccess, которая предоставляет доступ ко всем операциям без ограничений

## Задание 2. Настройка Zero-Spend Budget

Создаю бюджет, который предупредит меня когда мои расходы превысят 0

## Задание 3. Создание и запуск EC2 экземпляра (виртуальной машины)

Создаю instance EC2 даю имя, выбираю образ виртуальной машины, настраиваю подключение через ключ, настраиваю возможность подключения через ssh и http
Затем добавляю скрипт который необходимо запустить при создании instance, который устанавливает htop и nginx

> User Data — это скрипт, выполняемый при первом запуске EC2-инстанса для автоматической настройки системы или установки ПО

После чего запускаю и проверяю работоспособность

## Задание 4. Логирование и мониторинг

Проверяю статус запущенного сервера, затем рассматриваю графики во вкладке Monitoring 

По умолчанию включён базовый мониторинг (Basic monitoring) — данные отправляются в CloudWatch каждые 5 минут.
При необходимости можно включить детализированный мониторинг (Detailed monitoring) — метрики будут отправляться каждую минуту.

Детализированный мониторинг важно включать, когда требуется быстрое обнаружение и реагирование на изменения состояния инстанса
Например, высоконагруженные приложения, где задержка в 5 минут критична.

Затем рассматриваю логи и снимки инстанса

## Задание 5. Подключение к EC2 инстансу по SSH

В терминале подключаюсь к удаленному серверу через ssh и ключу сгенерированному ранее

```
ssh -i yournickname-keypair.pem ec2-user@<Public-IP>
```

В AWS по умолчанию для SSH-доступа к EC2 используется ключи, а не пароли, потому что:

1. Безопасность: ключи гораздо сложнее подобрать или взломать, чем пароль.
1. Предотвращение brute-force атак: пароли подвержены атакам перебором, а с ключами такие атаки практически невозможны.
1. Автоматизация и масштабирование: ключи легко использовать для автоматического подключения скриптов и управления множеством инстансов без ручного ввода пароля.

## Задание 6b. Развёртывание веб-сайта на PHP (Для специализаций Frontend & Backend & Security)

Копирую сайт при помощи scp
```
scp -i yournickname-keypair.pem -r /path/to/your/php-website/* ec2-user@<Public-IP>:/usr/share/nginx/html
```

Подключаюсь к инстансу и устанавливаю nginx и php

Настраиваю конфиг nginx, после чего перезапускаю его и проверяю сайт на работоспособность

![test](https://github.com/alexyakimenko/php_assessment_1/blob/master/screenshots/main_page.png?raw=true)

## Задание 7. Завершение работы и удаление ресурсов

Устанавливаю aws cli
В настройках пользователя добавляю Access Keys для дальнейшего подключения через CLI

После успешного подключения ввожу

```
aws ec2 stop-instances --instance-ids <instance-id>
```

После чего получаю 

```json
{
    "StoppingInstances": [
        {
            "InstanceId": "<id>",
            "CurrentState": {
                "Code": 64,
                "Name": "stopping"
            },
            "PreviousState": {
                "Code": 16,
                "Name": "running"
            }
        }
    ]
}
```


В AWS EC2:

Stop (Остановить) — инстанс останавливается, но сохраняет все данные на дисках EBS, и вы можете позже запустить его снова;

Terminate (Завершить/Удалить) — инстанс полностью удаляется, вместе с ним удаляются временные диски (instance store), и восстановить его уже нельзя.


